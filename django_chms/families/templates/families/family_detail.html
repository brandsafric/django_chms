{% extends "layout.html" %}
{% load humanize family_extras %}

{% block title %}The {{ family.family_name }} Family{% endblock %}
{% block content %}
<article>
		<h2>The {{ family.family_name }} Family</h2>
		<table style="width:100%">
				<tr>
				<td>
						<div>
								<ul style="list-style-type:none">
        			<li>{{ family.address1 }}</li>
        			<li>{{ family.address2 }}</li>
					<li>{{ family.city }}</li>
        			<li>{{ family.postal_code }}</li>
        			<li>{{ family.state }}</li>
        			<li>{{ family.country }}</li>
								</ul>
						</div>
				</td>
						<td>
								{% if family.image %}
							<img src="{{ family.image.url }}" alt="{{ family.family_name }} Family Photo" width="500">
								{% else %}
							<img src="/media/photos/family.png" alt="{{ family.family_name }} Family Photo" width="500">
								{% endif %}
						</td>
			</table>
        {{ family.notes|markdown_to_html}}
    {% if user.is_authenticated %}
            <a href="{% url 'families:edit_family' pk=family.pk %}"
                class="button">Edit Family Data</a>
			<br>
            <a href="{% url 'families:delete_family' pk=family.pk %}"
                class="button">Delete Family</a>
        <hr>
    {% endif %}

        <!--<p>There are {{ family.adult_set.count|apnumber }} adult member{{
            family.adult_set.count|pluralize }} of this family: {{
            family.adult_set.all|join:", " }}</p> -->
		<section>
				{% for member in family.adult_set.all %}
                    <h3> <a href="{{ member.get_absolute_url }}">{{ member.first_name }} </a> 
                    {% if member.last_name != family.family_name %}
					    {{ member.last_name }}
                    {% endif %}
                        </h3>
				{% endfor %}
				{% for member in family.child_set.all %}
                <h3> <a href="{{ member.get_absolute_url }}">{{ member.first_name }} </a>
                    {% if member.last_name != family.family_name %}
					    {{ member.last_name }}
                    {% endif %}
                    </h3>
				{% endfor %}
		</section>

    </article>
    {% if user.is_authenticated %}
        {% if family.adult_set.count < 2 %}
        <hr>
            <a href="{% url 'families:create_adult' family_pk=family.pk %}" class="button">New Adult</a>
            <br>
        {% endif %}
            <a href="{% url 'families:create_child' family_pk=family.pk %}" class="button">Add Child</a>
    {% endif %}
	<br>
	<a href="{% url 'families:list' %}">Back to list</a>
{% endblock %}
